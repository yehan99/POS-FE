<div class="hardware-config">
  <!-- Header -->
  <div class="config-header">
    <div class="header-content">
      <h1>
        <mat-icon>devices</mat-icon>
        {{ 'Hardware Configuration' }}
      </h1>
      <p class="subtitle">Manage and configure hardware devices for your POS system</p>
    </div>

    <!-- Connection Status Summary -->
    <div class="status-summary">
      <mat-card class="status-card">
        <div class="status-item">
          <mat-icon class="total-icon">devices</mat-icon>
          <div class="status-info">
            <div class="status-value">{{ connectionStatus.total }}</div>
            <div class="status-label">Total Devices</div>
          </div>
        </div>
      </mat-card>

      <mat-card class="status-card connected">
        <div class="status-item">
          <mat-icon class="connected-icon">check_circle</mat-icon>
          <div class="status-info">
            <div class="status-value">{{ connectionStatus.connected }}</div>
            <div class="status-label">Connected</div>
          </div>
        </div>
      </mat-card>

      <mat-card class="status-card disconnected">
        <div class="status-item">
          <mat-icon class="disconnected-icon">cancel</mat-icon>
          <div class="status-info">
            <div class="status-value">{{ connectionStatus.disconnected }}</div>
            <div class="status-label">Disconnected</div>
          </div>
        </div>
      </mat-card>

      <mat-card class="status-card error">
        <div class="status-item">
          <mat-icon class="error-icon">error</mat-icon>
          <div class="status-info">
            <div class="status-value">{{ connectionStatus.error }}</div>
            <div class="status-label">Error</div>
          </div>
        </div>
      </mat-card>
    </div>
  </div>

  <div class="config-content">
    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Actions -->
      <div class="actions-section">
        <h3>Actions</h3>
        <button mat-raised-button color="primary" [matMenuTriggerFor]="addMenu" class="action-btn">
          <mat-icon>add</mat-icon>
          Add Device
        </button>
        <mat-menu #addMenu="matMenu">
          <button mat-menu-item (click)="addDevice(deviceTypes[0])">
            <mat-icon>print</mat-icon>
            <span>Printer</span>
          </button>
          <button mat-menu-item (click)="addDevice(deviceTypes[1])">
            <mat-icon>qr_code_scanner</mat-icon>
            <span>Scanner</span>
          </button>
          <button mat-menu-item (click)="addDevice(deviceTypes[2])">
            <mat-icon>point_of_sale</mat-icon>
            <span>Cash Drawer</span>
          </button>
          <button mat-menu-item (click)="addDevice(deviceTypes[3])">
            <mat-icon>credit_card</mat-icon>
            <span>Payment Terminal</span>
          </button>
        </mat-menu>

        <button mat-raised-button (click)="toggleEventLog()" class="action-btn">
          <mat-icon>event_note</mat-icon>
          {{ showEventLog ? 'Hide' : 'Show' }} Event Log
        </button>

        <button mat-raised-button color="warn" (click)="clearAllDevices()" class="action-btn">
          <mat-icon>delete_sweep</mat-icon>
          Clear All
        </button>
      </div>

      <!-- Filters -->
      <div class="filters-section">
        <h3>Filters</h3>

        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Search</mat-label>
          <input matInput [(ngModel)]="searchQuery" (ngModelChange)="applyFilters()" placeholder="Search devices...">
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Device Type</mat-label>
          <mat-select [(value)]="filterType" (selectionChange)="applyFilters()">
            <mat-option value="ALL">All Types</mat-option>
            <mat-option *ngFor="let type of deviceTypes" [value]="type">{{ type }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Device List -->
      <div class="device-list" *ngIf="!showEventLog">
        <div class="list-header">
          <h2>Devices ({{ filteredDevices.length }})</h2>
        </div>

        <div class="devices-grid" *ngIf="filteredDevices.length > 0">
          <mat-card *ngFor="let device of filteredDevices" class="device-card"
            [class.selected]="selectedDevice?.id === device.id" (click)="selectDevice(device)">
            <mat-card-header>
              <div mat-card-avatar class="device-avatar" [class.disabled]="!device.enabled">
                <mat-icon>{{ getDeviceIcon(device.type) }}</mat-icon>
              </div>
              <mat-card-title>{{ device.name }}</mat-card-title>
              <mat-card-subtitle>{{ device.type }}</mat-card-subtitle>

              <button mat-icon-button [matMenuTriggerFor]="deviceMenu" class="device-menu-btn"
                (click)="$event.stopPropagation()">
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #deviceMenu="matMenu">
                <button mat-menu-item (click)="testDevice(device)">
                  <mat-icon>play_arrow</mat-icon>
                  <span>Test Connection</span>
                </button>
                <button mat-menu-item *ngIf="device.type === 'PRINTER'" (click)="testPrint(device)">
                  <mat-icon>print</mat-icon>
                  <span>Test Print</span>
                </button>
                <button mat-menu-item *ngIf="device.type === 'CASH_DRAWER'" (click)="testDrawer(device)">
                  <mat-icon>launch</mat-icon>
                  <span>Open Drawer</span>
                </button>
                <button mat-menu-item *ngIf="device.type === 'PAYMENT_TERMINAL'" (click)="testTerminal(device)">
                  <mat-icon>credit_card</mat-icon>
                  <span>Test Terminal</span>
                </button>
                <mat-divider></mat-divider>
                <button mat-menu-item (click)="toggleDevice(device)">
                  <mat-icon>{{ device.enabled ? 'toggle_off' : 'toggle_on' }}</mat-icon>
                  <span>{{ device.enabled ? 'Disable' : 'Enable' }}</span>
                </button>
                <button mat-menu-item (click)="removeDevice(device)" class="danger-item">
                  <mat-icon>delete</mat-icon>
                  <span>Remove</span>
                </button>
              </mat-menu>
            </mat-card-header>

            <mat-card-content>
              <div class="device-info">
                <div class="info-row">
                  <mat-icon class="info-icon">cable</mat-icon>
                  <span>{{ device.connectionType }}</span>
                </div>
                <div class="info-row status-row">
                  <mat-chip [color]="getStatusColor(device.status)" selected>
                    <mat-icon class="status-icon">{{ getStatusIcon(device.status) }}</mat-icon>
                    {{ device.status }}
                  </mat-chip>
                </div>
                <div class="info-row" *ngIf="device.lastConnected">
                  <mat-icon class="info-icon">schedule</mat-icon>
                  <span class="last-connected">Last: {{ formatTimestamp(device.lastConnected) }}</span>
                </div>
                <div class="info-row error-row" *ngIf="device.error">
                  <mat-icon class="error-icon">error</mat-icon>
                  <span class="error-text">{{ device.error }}</span>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>

        <div class="empty-state" *ngIf="filteredDevices.length === 0">
          <mat-icon>devices_other</mat-icon>
          <h3>No devices found</h3>
          <p>Add your first hardware device to get started</p>
          <button mat-raised-button color="primary" [matMenuTriggerFor]="addMenuEmpty">
            <mat-icon>add</mat-icon>
            Add Device
          </button>
          <mat-menu #addMenuEmpty="matMenu">
            <button mat-menu-item (click)="addDevice(deviceTypes[0])">
              <mat-icon>print</mat-icon>
              <span>Printer</span>
            </button>
            <button mat-menu-item (click)="addDevice(deviceTypes[1])">
              <mat-icon>qr_code_scanner</mat-icon>
              <span>Scanner</span>
            </button>
            <button mat-menu-item (click)="addDevice(deviceTypes[2])">
              <mat-icon>point_of_sale</mat-icon>
              <span>Cash Drawer</span>
            </button>
            <button mat-menu-item (click)="addDevice(deviceTypes[3])">
              <mat-icon>credit_card</mat-icon>
              <span>Payment Terminal</span>
            </button>
          </mat-menu>
        </div>
      </div>

      <!-- Event Log -->
      <div class="event-log" *ngIf="showEventLog">
        <div class="log-header">
          <h2>Hardware Event Log</h2>
          <button mat-icon-button (click)="clearEventLog()" matTooltip="Clear log">
            <mat-icon>delete</mat-icon>
          </button>
        </div>

        <div class="events-list" *ngIf="recentEvents.length > 0">
          <mat-card *ngFor="let event of recentEvents" class="event-card">
            <div class="event-content">
              <div class="event-icon" [class.error]="event.type.includes('ERROR')">
                <mat-icon>{{ event.type.includes('ERROR') ? 'error' : event.type.includes('COMPLETE') ? 'check_circle' :
                  'info' }}</mat-icon>
              </div>
              <div class="event-details">
                <div class="event-type">{{ event.type }}</div>
                <div class="event-device">Device: {{ event.deviceId }}</div>
                <div class="event-time">{{ formatTimestamp(event.timestamp) }}</div>
                <div class="event-data" *ngIf="event.data">
                  <pre>{{ event.data | json }}</pre>
                </div>
                <div class="event-error" *ngIf="event.error">
                  <mat-icon>warning</mat-icon>
                  {{ event.error }}
                </div>
              </div>
            </div>
          </mat-card>
        </div>

        <div class="empty-state" *ngIf="recentEvents.length === 0">
          <mat-icon>event_note</mat-icon>
          <h3>No events yet</h3>
          <p>Hardware events will appear here</p>
        </div>
      </div>
    </div>
  </div>
</div>